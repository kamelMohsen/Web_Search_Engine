<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_66-ea) on Mon Jun 13 09:43:22 CEST 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>org.apache.lucene.search.join (Lucene 6.1.0 API)</title>
<meta name="date" content="2016-06-13">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="org.apache.lucene.search.join (Lucene 6.1.0 API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="../../../../../org/apache/lucene/search/join/package-summary.html">Package</a></li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Package</li>
<li>Next&nbsp;Package</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/lucene/search/join/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;org.apache.lucene.search.join</h1>
<div class="docSummary">
<div class="block">Support for index-time and query-time joins.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/BitSetProducer.html" title="interface in org.apache.lucene.search.join">BitSetProducer</a></td>
<td class="colLast">
<div class="block">A producer of <a href="../../../../../../core/org/apache/lucene/util/BitSet.html?is-external=true" title="class or interface in org.apache.lucene.util"><code>BitSet</code></a>s per segment.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/BlockJoinSelector.html" title="class in org.apache.lucene.search.join">BlockJoinSelector</a></td>
<td class="colLast">
<div class="block">Select a value from a block of documents.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/CheckJoinIndex.html" title="class in org.apache.lucene.search.join">CheckJoinIndex</a></td>
<td class="colLast">
<div class="block">Utility class to check a block join index.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/JoinUtil.html" title="class in org.apache.lucene.search.join">JoinUtil</a></td>
<td class="colLast">
<div class="block">Utility for query time joining.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/QueryBitSetProducer.html" title="class in org.apache.lucene.search.join">QueryBitSetProducer</a></td>
<td class="colLast">
<div class="block">A <a href="../../../../../org/apache/lucene/search/join/BitSetProducer.html" title="interface in org.apache.lucene.search.join"><code>BitSetProducer</code></a> that wraps a query and caches matching
 <a href="../../../../../../core/org/apache/lucene/util/BitSet.html?is-external=true" title="class or interface in org.apache.lucene.util"><code>BitSet</code></a>s per segment.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/ToChildBlockJoinQuery.html" title="class in org.apache.lucene.search.join">ToChildBlockJoinQuery</a></td>
<td class="colLast">
<div class="block">Just like <a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinQuery.html" title="class in org.apache.lucene.search.join"><code>ToParentBlockJoinQuery</code></a>, except this
 query joins in reverse: you provide a Query matching
 parent documents and it joins down to child
 documents.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinCollector.html" title="class in org.apache.lucene.search.join">ToParentBlockJoinCollector</a></td>
<td class="colLast">
<div class="block">Collects parent document hits for a Query containing one more more
  BlockJoinQuery clauses, sorted by the
  specified parent Sort.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinIndexSearcher.html" title="class in org.apache.lucene.search.join">ToParentBlockJoinIndexSearcher</a></td>
<td class="colLast">
<div class="block">An <a href="../../../../../../core/org/apache/lucene/search/IndexSearcher.html?is-external=true" title="class or interface in org.apache.lucene.search"><code>IndexSearcher</code></a> to use in conjunction with
 <a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinCollector.html" title="class in org.apache.lucene.search.join"><code>ToParentBlockJoinCollector</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinQuery.html" title="class in org.apache.lucene.search.join">ToParentBlockJoinQuery</a></td>
<td class="colLast">
<div class="block">This query requires that you index
 children and parent docs as a single block, using the
 <a href="../../../../../../core/org/apache/lucene/index/IndexWriter.html?is-external=true#addDocuments-java.lang.Iterable-" title="class or interface in org.apache.lucene.index"><code>IndexWriter.addDocuments()</code></a> or <a href="../../../../../../core/org/apache/lucene/index/IndexWriter.html?is-external=true#updateDocuments-org.apache.lucene.index.Term-java.lang.Iterable-" title="class or interface in org.apache.lucene.index"><code>IndexWriter.updateDocuments()</code></a> API.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinQuery.ChildrenMatchesScorer.html" title="class in org.apache.lucene.search.join">ToParentBlockJoinQuery.ChildrenMatchesScorer</a></td>
<td class="colLast">
<div class="block">Ascendant for <a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinQuery.html" title="class in org.apache.lucene.search.join"><code>ToParentBlockJoinQuery</code></a>'s scorer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinSortField.html" title="class in org.apache.lucene.search.join">ToParentBlockJoinSortField</a></td>
<td class="colLast">
<div class="block">A special sort field that allows sorting parent docs based on nested / child level fields.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Enum Summary table, listing enums, and an explanation">
<caption><span>Enum Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Enum</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/BlockJoinSelector.Type.html" title="enum in org.apache.lucene.search.join">BlockJoinSelector.Type</a></td>
<td class="colLast">
<div class="block">Type of selection to perform.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/search/join/ScoreMode.html" title="enum in org.apache.lucene.search.join">ScoreMode</a></td>
<td class="colLast">
<div class="block">How to aggregate multiple child hit scores into a single parent score.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package org.apache.lucene.search.join Description">Package org.apache.lucene.search.join Description</h2>
<div class="block">Support for index-time and query-time joins.
 <h2>Index-time joins</h2>

 <p>The index-time joining support joins while searching, where joined
   documents are indexed as a single document block using
   <a href="../../../../../../core/org/apache/lucene/index/IndexWriter.html?is-external=true#addDocuments-java.lang.Iterable-" title="class or interface in org.apache.lucene.index"><code>IndexWriter.addDocuments()</code></a>.  
   This is useful for any normalized content (XML documents or database tables).  In database terms, all rows for all
   joined tables matching a single row of the primary table must be
   indexed as a single document block, with the parent document
   being last in the group.</p>
 
 <p>When you index in this way, the documents in your index are divided
   into parent documents (the last document of each block) and child
   documents (all others).  You provide a <a href="../../../../../org/apache/lucene/search/join/BitSetProducer.html" title="interface in org.apache.lucene.search.join"><code>BitSetProducer</code></a> that identifies the
   parent documents, as Lucene does not currently record any information
   about doc blocks.</p>
 
 <p>At search time, use <a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinQuery.html" title="class in org.apache.lucene.search.join"><code>ToParentBlockJoinQuery</code></a> to remap/join
   matches from any child <a href="../../../../../../core/org/apache/lucene/search/Query.html?is-external=true" title="class or interface in org.apache.lucene.search"><code>Query</code></a> (ie, a
   query that matches only child documents) up to the parent document
   space.  The
   resulting query can then be used as a clause in any query that
   matches parent.</p>
 
 <p>If you only care about the parent documents matching the query, you
   can use any collector to collect the parent hits, but if you'd also
   like to see which child documents match for each parent document,
   use the <a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinCollector.html" title="class in org.apache.lucene.search.join"><code>ToParentBlockJoinCollector</code></a> to collect the hits. Once the
   search is done, you retrieve a <a href="../../../../../../grouping/org/apache/lucene/search/grouping/TopGroups.html?is-external=true" title="class or interface in org.apache.lucene.search.grouping"><code>TopGroups</code></a> instance from the
   <a href="../../../../../org/apache/lucene/search/join/ToParentBlockJoinCollector.html#getTopGroups-org.apache.lucene.search.join.ToParentBlockJoinQuery-org.apache.lucene.search.Sort-int-int-int-boolean-"><code>ToParentBlockJoinCollector.getTopGroups()</code></a> method.</p>
 
 <p>To map/join in the opposite direction, use <a href="../../../../../org/apache/lucene/search/join/ToChildBlockJoinQuery.html" title="class in org.apache.lucene.search.join"><code>ToChildBlockJoinQuery</code></a>.  This wraps
   any query matching parent documents, creating the joined query
   matching only child documents.
 
 <h2>Query-time joins</h2>
 
 <p>
   The query time joining is index term based and implemented as two pass search. The first pass collects all the terms from a fromField
   that match the fromQuery. The second pass returns all documents that have matching terms in a toField to the terms
   collected in the first pass.
 </p>
 <p>Query time joining has the following input:</p>
 <ul>
   <li><code>fromField</code>: The from field to join from.
   <li><code>fromQuery</code>:  The query executed to collect the from terms. This is usually the user specified query.
   <li><code>multipleValuesPerDocument</code>:  Whether the fromField contains more than one value per document
   <li><code>scoreMode</code>:  Defines how scores are translated to the other join side. If you don't care about scoring
   use <a href="../../../../../org/apache/lucene/search/join/ScoreMode.html#None"><code>ScoreMode.None</code></a> mode. This will disable scoring and is therefore more
   efficient (requires less memory and is faster).
   <li><code>toField</code>: The to field to join to
 </ul>
 <p>
   Basically the query-time joining is accessible from one static method. The user of this method supplies the method
   with the described input and a <code>IndexSearcher</code> where the from terms need to be collected from. The returned
   query can be executed with the same <code>IndexSearcher</code>, but also with another <code>IndexSearcher</code>.
   Example usage of the <a href="../../../../../org/apache/lucene/search/join/JoinUtil.html#createJoinQuery-java.lang.String-boolean-java.lang.String-org.apache.lucene.search.Query-org.apache.lucene.search.IndexSearcher-org.apache.lucene.search.join.ScoreMode-"><code>JoinUtil.createJoinQuery()</code></a> :
 </p>
 <pre class="prettyprint">
   String fromField = "from"; // Name of the from field
   boolean multipleValuesPerDocument = false; // Set only yo true in the case when your fromField has multiple values per document in your index
   String toField = "to"; // Name of the to field
   ScoreMode scoreMode = ScoreMode.Max // Defines how the scores are translated into the other side of the join.
   Query fromQuery = new TermQuery(new Term("content", searchTerm)); // Query executed to collect from values to join to the to values
 
   Query joinQuery = JoinUtil.createJoinQuery(fromField, multipleValuesPerDocument, toField, fromQuery, fromSearcher, scoreMode);
   TopDocs topDocs = toSearcher.search(joinQuery, 10); // Note: toSearcher can be the same as the fromSearcher
   // Render topDocs...
 </pre></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="../../../../../org/apache/lucene/search/join/package-summary.html">Package</a></li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Package</li>
<li>Next&nbsp;Package</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/lucene/search/join/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
          <i>Copyright &copy; 2000-2016 Apache Software Foundation.  All Rights Reserved.</i>
          <script src='../../../../../prettify.js' type='text/javascript'></script>
          <script type='text/javascript'>
            (function(){
              var oldonload = window.onload;
              if (typeof oldonload != 'function') {
                window.onload = prettyPrint;
              } else {
                window.onload = function() {
                  oldonload();
                  prettyPrint();
                }
              }
            })();
          </script>
        </small></p>
</body>
</html>
